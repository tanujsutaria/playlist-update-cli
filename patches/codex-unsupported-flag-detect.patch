diff --git a/src/scoring.py b/src/scoring.py
index 14b8014..4b29cb2 100644
--- a/src/scoring.py
+++ b/src/scoring.py
@@ -3,6 +3,7 @@ from __future__ import annotations
 import json
 import logging
 import os
+import re
 import shlex
 import subprocess
 from dataclasses import dataclass
@@ -296,6 +297,11 @@ class WebSearchScoreProvider(ScoreProvider):
                     logger.info("Retrying %s with codex exec (non-interactive)", label)
                     return self._run_command(label, "codex exec -", payload)
                 if label == "codex" and self._stderr_unknown_argument(result.stderr):
+                    flag = self._stderr_unknown_argument_flag(result.stderr)
+                    if flag:
+                        logger.info("Retrying %s without unsupported flag %s", label, flag)
+                        stripped = self._strip_flag(args, flag, takes_value=(flag == "--output-schema"))
+                        return self._run_command(label, " ".join(stripped), payload)
                     logger.info("Retrying %s without unsupported codex flags", label)
                     stripped = self._strip_flag(args, "--search", takes_value=False)
                     return self._run_command(label, " ".join(stripped), payload)
@@ -343,6 +349,13 @@ class WebSearchScoreProvider(ScoreProvider):
         lowered = (stderr or "").lower()
         return "unexpected argument" in lowered
 
+    @staticmethod
+    def _stderr_unknown_argument_flag(stderr: str) -> Optional[str]:
+        match = re.search(r"unexpected argument '([^']+)'", stderr, flags=re.IGNORECASE)
+        if match:
+            return match.group(1)
+        return None
+
     @staticmethod
     def _strip_flag(args: List[str], flag: str, takes_value: bool) -> List[str]:
         if flag not in args:
diff --git a/src/web_search.py b/src/web_search.py
index 3c67174..218a9df 100644
--- a/src/web_search.py
+++ b/src/web_search.py
@@ -263,6 +263,13 @@ def _run_command(label: str, command: str, payload: dict, timeout_sec: int) -> T
                 args, input_text = _prepare_codex_command(["codex", "exec", "-"], payload)
                 return _run_command(label, " ".join(args), payload, timeout_sec)
             if label == "codex" and _stderr_unknown_argument(result.stderr):
+                flag = _stderr_unknown_argument_flag(result.stderr)
+                if flag:
+                    logger.info("Retrying %s without unsupported flag %s", label, flag)
+                    args = _strip_flag(args, flag, takes_value=(flag == "--output-schema"))
+                    if flag == "--search":
+                        logger.warning("Codex CLI does not support --search; running without web search.")
+                    return _run_command(label, " ".join(args), payload, timeout_sec)
                 logger.info("Retrying %s without unsupported codex flags", label)
                 args = _strip_flag(args, "--search", takes_value=False)
                 args = _strip_flag(args, "--output-schema", takes_value=True)
@@ -324,6 +331,13 @@ def _stderr_unknown_argument(stderr: str) -> bool:
     return "unexpected argument" in lowered
 
 
+def _stderr_unknown_argument_flag(stderr: str) -> Optional[str]:
+    match = re.search(r"unexpected argument '([^']+)'", stderr, flags=re.IGNORECASE)
+    if match:
+        return match.group(1)
+    return None
+
+
 def _parse_json_output(text: str) -> Optional[object]:
     if text:
         candidate = text.strip()
